{"version":3,"sources":["portfolio/ui/canvas/zoom.cljs"],"mappings":"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","names":["portfolio.ui.canvas.zoom/reset-canvas-zoom","_","el","opt","cljs.core/contains?","body","portfolio.ui.components.canvas/get-iframe-body","portfolio.ui.canvas.zoom/zoom","lvl","size","p__45291","map__45295","cljs.core/--destructure-map","cljs.core.get","portfolio.ui.canvas.zoom/prepare-zoom-button","tool","state","pane-options","pane-id","level","or__5045__auto__","increment","portfolio.ui.components.canvas-toolbar-buttons/Button","cljs.core/with-meta","portfolio.ui.canvas.addons/get-set-actions","portfolio.ui.canvas.zoom/impl","portfolio.ui.canvas.zoom/create-zoom-in-tool","config","phosphor.icons/load-icon!","portfolio.ui.canvas.zoom/create-zoom-out-tool","portfolio.ui.canvas.zoom/create-reset-zoom-tool","portfolio.ui.canvas.addons/create-action-button","p__45302","map__45303","portfolio.ui.canvas.addons/get-clear-actions","p__45304","map__45305","and__5043__auto__","cljs.core.not_EQ_","portfolio.ui.canvas.zoom/prepare-button-group","portfolio.ui.components.canvas-toolbar-buttons/ButtonGroup","p1__45306#","cljs.core.keep","portfolio.ui.canvas.protocols/prepare-toolbar-button","portfolio.ui.canvas.zoom/create-zoom-tool","portfolio.ui.canvas.addons.get_tool_value"],"sourcesContent":["(ns portfolio.ui.canvas.zoom\n  (:require [phosphor.icons :as icons]\n            [portfolio.ui.canvas.addons :as addons]\n            [portfolio.ui.canvas.protocols :as protocols]\n            [portfolio.ui.components.canvas :as canvas]\n            [portfolio.ui.components.canvas-toolbar-buttons :refer [Button ButtonGroup]]))\n\n(defn reset-canvas-zoom [_ el opt]\n  (when-not (contains? opt :zoom/level)\n    (let [body (canvas/get-iframe-body el)]\n      (set! (.. body -style -transform) \"\")\n      (set! (.. body -style -width) \"100%\")\n      (set! (.. body -style -height) \"100%\"))))\n\n(defn zoom [el opt]\n  (let [body (canvas/get-iframe-body el)\n        lvl (:zoom/level opt)]\n    (cond\n      lvl\n      (let [size (str (/ 100 lvl) \"%\")]\n        (set! (.. body -zoomed) true)\n        (set! (.. body -style -transform) (str \"scale(\" lvl \")\"))\n        (set! (.. body -style -transformOrigin) \"left top\")\n        (set! (.. body -style -width) size)\n        (set! (.. body -style -height) size))\n\n      (.. body -zoomed)\n      (reset-canvas-zoom nil el opt))))\n\n(defn prepare-zoom-button [tool state {:keys [pane-options pane-id]}]\n  (let [level (or (:zoom/level pane-options) 1)\n        increment (or (:zoom-increment tool) 0.25)]\n    (with-meta\n      {:title (:title tool)\n       :icon (:icon tool)\n       :active? (if (< 0 increment)\n                  (< 1 level)\n                  (< level 1))\n       :actions (addons/get-set-actions state tool pane-id {:zoom/level (+ increment level)})}\n      {`protocols/render-toolbar-button #'Button})))\n\n(def impl\n  {`protocols/prepare-canvas (fn [_ el opt] (zoom el opt))\n   `protocols/finalize-canvas (fn [_ _ _])\n   `protocols/prepare-toolbar-button #'prepare-zoom-button})\n\n(defn create-zoom-in-tool [config]\n  (with-meta\n    {:id :canvas/zoom-in\n     :group-id :canvas/zoom\n     :title \"Zoom in\"\n     :icon (icons/icon :phosphor.regular/magnifying-glass-plus)\n     :zoom-increment (or (:zoom-increment config) 0.25)}\n    impl))\n\n(defn create-zoom-out-tool [config]\n  (with-meta\n    {:id :canvas/zoom-out\n     :group-id :canvas/zoom\n     :title \"Zoom out\"\n     :icon (icons/icon :phosphor.regular/magnifying-glass-minus)\n     :zoom-increment (or (:zoom-increment config) -0.25)}\n    impl))\n\n(defn create-reset-zoom-tool [config]\n  (addons/create-action-button\n   {:id :canvas/zoom-reset\n    :group-id :canvas/zoom\n    :title \"Reset zoom\"\n    :icon (icons/icon :phosphor.regular/arrow-counter-clockwise)\n    :prepare-canvas #'reset-canvas-zoom\n    :get-actions (fn [tool state {:keys [pane-id]}]\n                   (addons/get-clear-actions state tool pane-id))\n    :show? (fn [_ _ {:keys [pane-options]}]\n             (and (:zoom/level pane-options)\n                  (not= 1 (:zoom/level pane-options))))}))\n\n(defn prepare-button-group [tool state opt]\n  (with-meta\n    {:buttons (->> (:buttons tool)\n                   (keep #(protocols/prepare-toolbar-button % state opt)))}\n    {`protocols/render-toolbar-button #'ButtonGroup}))\n\n(defn create-zoom-tool [config]\n  (with-meta\n    {:id :canvas/zoom\n     :buttons [(create-zoom-out-tool config)\n               (create-zoom-in-tool config)\n               (create-reset-zoom-tool config)]}\n    {`protocols/prepare-canvas (fn [_ el opt] (zoom el opt))\n     `protocols/finalize-canvas (fn [_ _ _])\n     `protocols/prepare-toolbar-button #'prepare-button-group\n     `protocols/get-tool-value (fn [tool state pane-id] (addons/get-tool-value state tool pane-id))}))\n"],"x_google_ignoreList":[0]}